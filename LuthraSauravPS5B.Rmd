---
title: "LuthraSauravPS5B"
author: "Saurav Luthra"
date: "2025-04-16"
output:
  html_document: default
  pdf_document: default
editor_options:
  markdown:
    wrap: 72
---

# SAURAV LUTHRA, MTH643 PROBLEM SET 5B

## =========== SETUP ===========

```{r IMPORTS, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)

```


## =========== QUESTION 4A ===========

#### [**ARMA(2,1) Process of Length 50 with For-Loop**]

```{r QUESTION_4A, warning=FALSE}

set.seed(305)

# parameters
phi1   <- -0.5
phi2   <- 0.1
theta1 <- 0.3

# innovation vector with burn-in period
epsilon <- c(0, 0, 0, rnorm(47))

# initialize Y vector with length 50
Y <- rep(0, 50)

# set burn-in values
Y[1:3] <- 0

# generate ARMA(2,1) process using for loop
for (t in 4:50) {
  Y[t] <- phi1 * Y[t - 1] + phi2 * Y[t - 2] + epsilon[t] + theta1 * epsilon[t - 1]
}

# print the values
print(Y)

# plot the series
plot(Y, type = "l", main = "Simulated ARMA(2,1) Process with For-Loop", ylab = "Y", xlab = "Time")

```

## =========== QUESTION 4B ===========

#### [**ARMA(2,1) Process of Length 50 with arima.sim()**]

```{r QUESTION_4B, warning=FALSE}

set.seed(305) 

# define the innovations (same as before)
epsilon <- c(0, 0, 0, rnorm(47))

# use arima.sim with custom innovations
Y_sim <- arima.sim(n = 50, 
                   model = list(ar = c(-0.5, 0.1), ma = 0.3), 
                   innov = epsilon)

# display the series values
print(Y_sim)

# plot the series
plot(Y_sim, type = "l", main = "ARMA(2,1) Series via arima.sim", ylab = "Y", xlab = "Time")

```

## =========== QUESTION 4C ===========

#### [**Theoretical and Sample Auto Correlation Function of ARMA(2,1) Process**]

Using the ARMAacf() command to get the theoretical autocorrelation function of the same ARMA(2,1) process. Then using the acf() command to get the sample autocorrelation functions of the simulated processes from part A and part B. Both of these simulated ACFs are very, very similar which is to be expected. However, compared to the theoretical ACF, the simulated ones have higher absolute values (more autocorrelation) among their terms. This likely has to do with the difference in lengths between the two introducing more variance.

```{r QUESTION_4C, warning=FALSE}

# theoretical ACF for ARMA(2,1)
theoretical_acf <- ARMAacf(ar = c(-0.5, 0.1), ma = 0.3, lag.max = 20)
acf(theoretical_acf, main = 'Theoretical ACF')

acf(Y[1:20], main = "Sample ACF of Simulated ARMA(2,1) Process (part A)")
acf(Y_sim[1:20], main = "Sample ACF of Simulated ARMA(2,1) Process (part B)")

```

## =========== QUESTION 4D ===========

#### [**Sample Autocorrelations of 3 Realizations of ARMA(2,1) Process Using arima.sim()**]

After creating 3 realizations of the ARMA(2,1) process, we plot their actual values and their sample autocorrelation functions. Between the 3, the average value/range of autocorrelation terms is identical. However, the distribution of values is quite random which is expected. With the finite sample size (400), the stochastic variability of each sample is going to result in different values for each lag term, but since we have the same averages, and the same value at the first lag, we can say that this is what we would expect with 3 randomly generated ARMA(2,1) processes with all the same initial parameters.

```{r QUESTION_4D, warning=FALSE}

set.seed(305)

# define ARMA(2,1) parameters
ar_params <- c(-0.5, 0.1)
ma_params <- 0.3
n         <- 400

# generate 3 realizations
Y1 <- arima.sim(model = list(ar = ar_params, ma = ma_params), n = n)
Y2 <- arima.sim(model = list(ar = ar_params, ma = ma_params), n = n)
Y3 <- arima.sim(model = list(ar = ar_params, ma = ma_params), n = n)

# plot sample ACFs
acf(Y1, main = "Sample ACF: Realization 1")
acf(Y2, main = "Sample ACF: Realization 2")
acf(Y3, main = "Sample ACF: Realization 3")

y_range <- range(c(Y1, Y2, Y3))

# plot realizations
plot(Y1, type = "l", col = "blue",   ylim = y_range, main = "ARMA(2,1) Realization 1", ylab = "Value", xlab = "Time")
plot(Y2, type = "l", col = "red",    ylim = y_range, main = "ARMA(2,1) Realization 2", ylab = "Value", xlab = "Time")
plot(Y3, type = "l", col = "orange", ylim = y_range, main = "ARMA(2,1) Realization 3", ylab = "Value", xlab = "Time")

```